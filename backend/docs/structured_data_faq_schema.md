# CMS自动化系统 - FAQ Schema结构化数据生成需求文档

**版本:** 1.1.0
**创建日期:** 2025-10-26
**最后更新:** 2025-10-27
**状态:** 需求设计阶段
**优先级:** 中高（SEO增值功能）
**更新说明:** v1.1.0 FAQ生成集成到单一Prompt综合分析架构中

---

## 📋 目录

1. [概述](#1-概述)
2. [FAQ Schema标准规范](#2-faq-schema标准规范)
3. [业务价值与应用场景](#3-业务价值与应用场景)
4. [AI生成策略](#4-ai生成策略)
5. [多方案生成设计](#5-多方案生成设计)
6. [FAQ编辑器UI](#6-faq编辑器ui)
7. [WordPress集成](#7-wordpress集成)
8. [API接口设计](#8-api接口设计)
9. [质量评估与优化](#9-质量评估与优化)
10. [实现指南](#10-实现指南)

---

## 1. 概述

### 1.1 什么是FAQ Schema

**FAQ Schema** 是 Schema.org 定义的一种结构化数据格式，用于标记网页上的常见问题与答案（FAQ）内容。

**Schema.org 官方定义**:
- 类型: `FAQPage`
- 用途: 标记包含常见问题列表的页面
- 格式: JSON-LD（JavaScript Object Notation for Linked Data）

### 1.2 为什么需要FAQ Schema

#### SEO优势

| 优势 | 说明 | 效果 |
|------|------|------|
| **丰富搜索结果** | 在Google搜索结果中直接显示问答 | 提高点击率20-30% |
| **Featured Snippets** | 更容易被选为精选摘要 | 增加曝光率 |
| **语音搜索优化** | 适配语音助手的问答模式 | 覆盖语音搜索流量 |
| **用户体验** | 快速展示核心信息 | 降低跳出率 |
| **搜索排名提升** | 结构化数据有助于SEO | 提升搜索排名 |

#### Google搜索结果示例

```
┌─────────────────────────────────────────────────┐
│ 纽约新交通政策解析 - example.com               │
│ https://example.com/article-title               │
│                                                 │
│ 纽约市政府宣布新交通管理政策，旨在缓解拥堵...   │
│                                                 │
│ ❓ 新政策什么时候生效？                         │
│   新政策将从下月1日起正式实施...               │
│                                                 │
│ ❓ 限制措施包括哪些？                           │
│   主要包括增加公交车道、限制私家车进入...       │
│                                                 │
│ ❓ 对市民有什么影响？                           │
│   预计可减少15%通勤时间，但部分区域...         │
│                                                 │
│ [查看更多问答]                                  │
└─────────────────────────────────────────────────┘
```

### 1.3 本系统的目标

为CMS自动化系统提供**AI驱动的FAQ Schema自动生成能力**：

1. **自动化生成**: AI分析文章内容，自动提取和生成Q&A
2. **多方案选择**: 提供3/5/7个问答的不同方案
3. **用户可编辑**: 支持用户修改和完善AI生成的内容
4. **一键集成**: 自动生成JSON-LD代码，无缝集成到WordPress
5. **质量保证**: AI生成的Q&A准确、相关、有价值

---

## 2. FAQ Schema标准规范

### 2.1 Schema.org FAQPage定义

**完整JSON-LD格式**:

```json
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "问题文本（用户看到的问题）",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "答案文本（完整的答案内容）"
      }
    },
    {
      "@type": "Question",
      "name": "第二个问题",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "第二个答案"
      }
    }
  ]
}
```

### 2.2 字段规范

#### @context
- **值**: `"https://schema.org"`
- **必需**: 是
- **说明**: Schema.org命名空间声明

#### @type (页面级别)
- **值**: `"FAQPage"`
- **必需**: 是
- **说明**: 声明此页面类型为FAQ页面

#### mainEntity
- **类型**: 数组
- **必需**: 是
- **包含**: 一个或多个 `Question` 对象
- **最少**: 1个问答
- **建议**: 3-10个问答

#### Question对象

```json
{
  "@type": "Question",
  "name": "问题文本",
  "acceptedAnswer": {
    "@type": "Answer",
    "text": "答案文本"
  }
}
```

**字段说明**:

| 字段 | 类型 | 必需 | 说明 | 限制 |
|------|------|------|------|------|
| @type | String | 是 | 固定值"Question" | - |
| name | String | 是 | 问题全文 | 建议5-100字符 |
| acceptedAnswer | Object | 是 | Answer对象 | - |

#### Answer对象

```json
{
  "@type": "Answer",
  "text": "答案文本"
}
```

**字段说明**:

| 字段 | 类型 | 必需 | 说明 | 限制 |
|------|------|------|------|------|
| @type | String | 是 | 固定值"Answer" | - |
| text | String | 是 | 答案全文 | 建议50-500字符 |

**高级字段（可选）**:
```json
{
  "@type": "Answer",
  "text": "答案文本",
  "author": {
    "@type": "Person",
    "name": "作者名"
  },
  "dateCreated": "2025-10-26",
  "upvoteCount": 42
}
```

### 2.3 Google规范要求

#### 内容要求

✅ **允许的内容**:
- 真实的常见问题
- 对文章内容的准确概括
- 有价值的信息补充
- 清晰简洁的语言

❌ **不允许的内容**:
- 广告或促销内容
- 不雅或冒犯性内容
- 暴力或危险内容
- 虚假或误导性信息

#### 技术要求

1. **JSON-LD格式**: 必须使用JSON-LD（推荐），不使用Microdata或RDFa
2. **页面一致性**: JSON-LD内容必须与页面实际内容一致
3. **唯一性**: 每个页面只能有一个FAQPage标记
4. **完整性**: 问题和答案必须完整，不能截断

#### 验证工具

- **Rich Results Test**: https://search.google.com/test/rich-results
- **Schema Markup Validator**: https://validator.schema.org/

### 2.4 示例：完整FAQ Schema

#### 示例1：新闻文章FAQ

```json
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "纽约新交通政策什么时候生效？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "根据纽约市政府发布的声明，新交通管理政策将从下月1日起正式实施。政策实施将分为两个阶段：第一阶段（前3个月）为过渡期，仅警告不处罚；第二阶段（3个月后）开始全面执法。"
      }
    },
    {
      "@type": "Question",
      "name": "新政策包括哪些限制措施？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "新政策的主要措施包括：1) 在市中心增设10条专用公交车道；2) 工作日早7点至晚7点限制私家车进入曼哈顿中心区域；3) 提高市中心停车费用至每小时15美元；4) 新增1000辆公交车以应对需求增加。"
      }
    },
    {
      "@type": "Question",
      "name": "这对普通市民有什么影响？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "根据交通专家评估，新政策实施后，使用公共交通的通勤时间预计减少15%。但驾驶私家车进入市中心的市民需要改变出行方式，或支付更高的停车费用。市政府建议市民优先选择地铁、公交或自行车等环保出行方式。"
      }
    },
    {
      "@type": "Question",
      "name": "企业和商家如何应对？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "市中心的企业和商家有两方面关切：一方面担心客流量下降，另一方面期待交通改善带来的长期收益。市政府承诺提供3个月的税收减免作为补偿，并加强公交车站附近的商业宣传支持。"
      }
    },
    {
      "@type": "Question",
      "name": "如何获得豁免或特殊通行证？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "以下人群可申请豁免：残障人士、紧急服务车辆、运送货物的商业车辆（需注册）。申请流程：访问市交通局官网填写申请表，上传相关证明材料，等待5个工作日审核。豁免有效期为1年，到期需重新申请。"
      }
    }
  ]
}
```

#### 示例2：科技文章FAQ

```json
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "什么是人工智能（AI）？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "人工智能（AI）是计算机科学的一个分支，旨在创建能够执行通常需要人类智能的任务的系统。这些任务包括学习、推理、问题解决、感知和语言理解。现代AI主要基于机器学习技术，通过大量数据训练模型来完成特定任务。"
      }
    },
    {
      "@type": "Question",
      "name": "机器学习和深度学习有什么区别？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "机器学习是AI的一个子集，使计算机能够从数据中学习而无需明确编程。深度学习则是机器学习的一个子集，使用多层神经网络来处理复杂的数据模式。简单来说：AI包含机器学习，机器学习包含深度学习。深度学习在图像识别、语音处理等领域表现尤为出色。"
      }
    },
    {
      "@type": "Question",
      "name": "AI会取代人类的工作吗？",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "AI确实会改变劳动力市场，但并非简单的取代关系。研究表明，AI更可能自动化重复性任务，而非整个职业。同时，AI也会创造新的工作机会，如AI训练师、数据科学家等。关键是人类需要适应并学习与AI协作，发展AI无法替代的创造力、情感智能和复杂决策能力。"
      }
    }
  ]
}
```

---

## 3. 业务价值与应用场景

### 3.1 核心业务价值

#### 价值1：提升搜索可见性

**数据支持**:
- 带FAQ Schema的页面在搜索结果中的点击率提高**25-35%**
- Featured Snippet展示率提高**3-5倍**
- 移动搜索曝光率提高**40%**

**实现机制**:
```
文章内容 → AI提取关键信息 → 生成Q&A →
结构化数据 → Google索引 → 丰富搜索结果 →
更高点击率 → 更多流量
```

#### 价值2：优化用户体验

**用户收益**:
- 快速获取核心信息（不需阅读全文）
- 清晰的问答结构（易于扫描）
- 语音搜索友好（自然语言问答）

**编辑收益**:
- 自动化生成（节省时间）
- AI提供多方案（灵活选择）
- 可编辑完善（保持控制）

#### 价值3：内容质量提升

**强制效果**:
- AI分析迫使文章包含清晰要点
- 问答格式鼓励结构化写作
- 提高文章信息密度

### 3.2 适用场景

#### 场景1：新闻报道

**适用类型**:
- 政策解读
- 事件报道
- 突发新闻

**典型问题**:
- "什么时候发生的？"
- "主要内容是什么？"
- "有什么影响？"
- "下一步如何发展？"

#### 场景2：深度分析

**适用类型**:
- 专题报道
- 调查新闻
- 评论文章

**典型问题**:
- "核心观点是什么？"
- "有哪些证据支持？"
- "不同观点如何对比？"
- "结论和建议是什么？"

#### 场景3：教育科普

**适用类型**:
- 知识介绍
- 技术讲解
- 概念解释

**典型问题**:
- "这是什么？"
- "为什么重要？"
- "如何工作？"
- "有什么应用？"

#### 场景4：操作指南

**适用类型**:
- 使用教程
- 步骤说明
- 常见问题

**典型问题**:
- "如何操作？"
- "有哪些注意事项？"
- "遇到问题怎么解决？"
- "有替代方法吗？"

### 3.3 不适用场景

❌ **以下类型文章不建议使用FAQ Schema**:

1. **非常短的新闻**（<300字）
   - 理由：内容不足以提取有价值的Q&A

2. **纯观点评论**（无事实信息）
   - 理由：难以形成客观问答

3. **诗歌、文学作品**
   - 理由：不符合FAQ的信息检索性质

4. **图片集、视频集**（无实质文字内容）
   - 理由：缺乏可提取的文本信息

---

## 4. AI生成策略 (v1.1 单一Prompt集成)

> **重要变更 (v1.1)**: FAQ Schema生成已集成到**单一Prompt综合分析架构**中，不再作为独立的AI调用。
>
> - **旧版 (v1.0)**: 独立的FAQ生成调用，单独发送文章内容
> - **新版 (v1.1)**: 集成在综合分析中，与校对、Meta、关键词一起生成
> - **优势**: 术语自动与正文、Meta、关键词保持一致，无需额外AI调用

### 4.1 生成流程 (v1.1 集成架构)

```
┌─────────────────────────────────────────────────┐
│   单一 Prompt 综合分析 (ProofreadingAnalysisService)   │
│                                                 │
│   输入：文章全文（正文 + Meta + 关键词）          │
└────────────────────┬────────────────────────────┘
                     │
                     ▼
┌──────────────────────────────────────────────────┐
│          AI 在统一上下文中同时完成：               │
│                                                  │
│  1. 内容分析与校对 (A-F类规则)                    │
│  2. Meta描述优化                                 │
│  3. SEO关键词提取                                │
│  4. FAQ Schema生成 ← 本节重点                    │
│     ├─ 步骤1：基于正文识别核心主题                 │
│     ├─ 步骤2：应用5W1H原则生成问题                │
│     ├─ 步骤3：从正文提取/概括答案                  │
│     ├─ 步骤4：质量检查（相关性、准确性）            │
│     └─ 步骤5：生成3/5/7三个版本                   │
│                                                  │
│  ✅ 术语一致性：自动与正文、Meta、关键词对齐       │
└────────────────────┬─────────────────────────────┘
                     │
                     ▼
┌──────────────────────────────────────────────────┐
│   输出：完整JSON结果                              │
│   └─ faq_schema:                                 │
│      ├─ version_3: { ... }                       │
│      ├─ version_5: { ... }                       │
│      └─ version_7: { ... }                       │
└──────────────────────────────────────────────────┘
```

**v1.1 架构的关键优势:**

| 维度 | 旧版 (独立调用) | 新版 (集成) | 改进 |
|------|---------------|-----------|------|
| AI调用次数 | +1次额外调用 | 集成在综合分析中 | 减少1次调用 |
| 术语一致性 | 可能不一致 | ✅ 自动保持一致 | 质量提升 |
| 处理时间 | +额外2-3秒 | 无额外时间 | 性能提升 |
| Token成本 | 文章内容重复发送 | 文章内容只发送一次 | 成本节省 |

**示例**：如果正文使用"纽约市政府"，FAQ的问题和答案会自动使用相同的术语，不会出现"纽约政府"或"NYC政府"的不一致情况。

### 4.2 问题生成策略

#### 4.2.1 5W1H原则

| 类型 | 问题词 | 示例 | 适用场景 |
|------|--------|------|---------|
| **What** | 什么、是什么 | "这项政策是什么？" | 定义、介绍 |
| **Who** | 谁、哪些人 | "谁受到影响？" | 人物、对象 |
| **When** | 何时、什么时候 | "政策什么时候生效？" | 时间、期限 |
| **Where** | 哪里、在哪 | "在哪些地区实施？" | 地点、范围 |
| **Why** | 为什么、原因 | "为什么推出这项政策？" | 原因、动机 |
| **How** | 如何、怎样 | "如何申请豁免？" | 方法、步骤 |

#### 4.2.2 用户搜索意图分类

| 意图类型 | 说明 | 问题示例 |
|---------|------|---------|
| **信息型** | 寻求知识或信息 | "人工智能是什么？" |
| **导航型** | 寻找特定页面/资源 | "在哪里申请？" |
| **交易型** | 准备采取行动 | "如何购买？" |
| **调查型** | 比较和研究 | "有哪些优缺点？" |

#### 4.2.3 问题优先级排序

**优先级规则**:

1. **核心主题问题**（P0）
   - "文章主要讲什么？"
   - "核心观点是什么？"

2. **关键事实问题**（P1）
   - 时间："什么时候？"
   - 地点："在哪里？"
   - 对象："谁受影响？"

3. **细节信息问题**（P2）
   - "具体包括哪些内容？"
   - "有哪些例外情况？"

4. **延伸问题**（P3）
   - "这意味着什么？"
   - "未来会如何发展？"

### 4.3 答案生成策略

#### 4.3.1 答案来源

**优先级顺序**:

1. **直接引用**（最高优先级）
   - 文章中明确说明的内容
   - 直接回答问题的段落
   - 可能需要轻微改写以适应问答格式

2. **内容概括**
   - 多个段落的综合
   - 提炼核心要点
   - 保持准确性和完整性

3. **逻辑推断**（谨慎使用）
   - 基于文章内容的合理推断
   - 必须有充分依据
   - 不能超出文章范围

❌ **禁止的答案来源**:
- 外部信息（文章未提及的内容）
- AI的猜测或假设
- 不准确或误导性的改写

#### 4.3.2 答案长度控制

| 问题类型 | 建议长度 | 说明 |
|---------|---------|------|
| **定义性** | 50-100字 | 简明扼要 |
| **事实性** | 80-150字 | 包含关键细节 |
| **解释性** | 150-300字 | 充分说明 |
| **步骤性** | 200-400字 | 完整流程 |

#### 4.3.3 答案质量要求

✅ **好的答案**:
- 直接回答问题（不绕圈子）
- 信息完整（包含必要细节）
- 语言清晰（易于理解）
- 基于事实（有文章支撑）
- 结构清晰（使用分点、数字等）

❌ **差的答案**:
- 模糊不清
- 信息不足
- 偏离问题
- 包含未经证实的内容
- 过于冗长或过于简短

### 4.4 AI Prompt设计

#### Prompt模板1：问题生成

```
你是一个SEO专家和内容分析师。请为以下文章生成FAQ（常见问题）。

【文章标题】
{article_title}

【文章正文】（前1500字）
{article_content[:1500]}

【Meta描述】
{meta_description}

【任务要求】
1. 生成{num_questions}个最重要的常见问题
2. 问题必须基于文章内容，不能超出范围
3. 问题应遵循5W1H原则（什么、谁、何时、哪里、为什么、如何）
4. 问题应反映用户真实的搜索意图
5. 问题用清晰的疑问句表达，5-20字
6. 按重要性排序（最重要的在前）

【输出格式】
返回JSON数组格式：
[
  {
    "question": "问题1",
    "priority": "P0",
    "question_type": "what|who|when|where|why|how",
    "search_intent": "informational|navigational|transactional",
    "reasoning": "为什么这个问题重要"
  },
  ...
]

请生成问题：
```

#### Prompt模板2：答案生成

```
你是一个专业的内容编辑。请为以下问题生成答案。

【文章正文】
{article_content}

【问题】
{question}

【任务要求】
1. 答案必须基于文章内容，直接从文章中提取或概括
2. 答案要直接、完整地回答问题
3. 答案长度：{min_length}-{max_length}字
4. 使用清晰、易懂的语言
5. 如果适合，使用分点或数字列举
6. 不要包含文章未提及的信息
7. 不要使用"根据文章"、"文中提到"等元语言

【输出格式】
返回JSON格式：
{
  "answer": "答案文本",
  "confidence": 0.95,
  "source_paragraphs": ["段落1索引", "段落2索引"],
  "answer_type": "direct_quote|summarized|inferred",
  "reasoning": "答案生成的依据"
}

请生成答案：
```

#### Prompt模板3：质量检查

```
你是一个质量审核员。请检查以下FAQ问答的质量。

【问答对】
问题: {question}
答案: {answer}

【原文章】（前500字）
{article_content[:500]}

【检查项】
1. 问题是否清晰明确？
2. 答案是否直接回答了问题？
3. 答案是否基于文章内容？
4. 答案长度是否合适（50-400字）？
5. 答案是否包含足够细节？
6. 语言是否清晰易懂？
7. 是否有事实错误？
8. 是否有SEO价值？

【输出格式】
返回JSON格式：
{
  "overall_quality": 0.88,
  "passes_check": true,
  "issues": [
    {"type": "warning", "message": "答案稍长，建议精简"}
  ],
  "suggestions": [
    "可以在答案开头直接回答，再补充细节"
  ],
  "seo_score": 0.92
}

请检查质量：
```

---

## 5. 多方案生成设计

### 5.1 为什么需要多方案

**用户需求多样性**:
- 简短新闻：3个Q&A足够
- 中等文章：5个Q&A平衡详细和简洁
- 深度报道：7个Q&A全面覆盖

**灵活性**:
- 用户可根据文章类型选择
- 可对比不同方案
- 可混合使用（选择不同方案中的问答）

### 5.2 三种方案设计

#### 方案1：简洁版（3个问答）

**定位**: 核心信息快速呈现

**适用场景**:
- 短新闻（300-800字）
- 简单事件报道
- 移动端优先展示

**问题选择策略**:
1. **核心主题问题**（必选）
   - "文章主要讲什么？"
   - "核心事件是什么？"

2. **最重要的事实问题**（必选）
   - 时间、地点、对象中最关键的一个

3. **最关注的影响问题**（必选）
   - "有什么影响？"
   - "对我有什么关系？"

**示例**:
```json
{
  "proposal_id": "faq_3q",
  "name": "简洁版（3个问答）",
  "description": "适合短新闻和移动端",
  "item_count": 3,
  "items": [
    {
      "question": "纽约新交通政策主要内容是什么？",
      "answer": "新政策包括增加10条公交专用道、限制私家车进入市中心、提高停车费用至每小时15美元，以及新增1000辆公交车。"
    },
    {
      "question": "政策什么时候生效？",
      "answer": "新政策将从下月1日起实施，分为3个月过渡期（仅警告）和之后的全面执法期。"
    },
    {
      "question": "对市民有什么影响？",
      "answer": "使用公共交通的通勤时间预计减少15%，但驾驶私家车进入市中心需支付更高费用。市政府建议优先选择地铁、公交或自行车。"
    }
  ]
}
```

#### 方案2：标准版（5个问答）

**定位**: 平衡详细性和可读性

**适用场景**:
- 标准新闻（800-1500字）
- 大多数文章类型
- 桌面和移动端兼顾

**问题选择策略**:
1. 核心主题问题（1个）
2. 关键事实问题（2个）
   - 时间、地点、对象中的2-3个
3. 影响和结果问题（1个）
4. 操作或延伸问题（1个）

**示例**:
```json
{
  "proposal_id": "faq_5q",
  "name": "标准版（5个问答）",
  "description": "适合大多数文章",
  "item_count": 5,
  "items": [
    {
      "question": "纽约新交通政策主要内容是什么？",
      "answer": "..."
    },
    {
      "question": "政策什么时候生效？",
      "answer": "..."
    },
    {
      "question": "新政策包括哪些限制措施？",
      "answer": "主要措施包括：1) 增设10条公交专用道；2) 工作日限制私家车进入曼哈顿中心；3) 停车费提高至每小时15美元；4) 新增1000辆公交车。"
    },
    {
      "question": "对市民有什么影响？",
      "answer": "..."
    },
    {
      "question": "如何获得豁免或特殊通行证？",
      "answer": "残障人士、紧急服务车辆、注册商业车辆可申请豁免。访问市交通局官网申请，5个工作日审核，有效期1年。"
    }
  ]
}
```

#### 方案3：详细版（7个问答）

**定位**: 全面覆盖文章内容

**适用场景**:
- 深度报道（1500字以上）
- 复杂事件
- 需要详细信息的专题

**问题选择策略**:
1. 核心主题问题（1个）
2. 关键事实问题（3个）
   - 5W1H全面覆盖
3. 细节和例外问题（2个）
4. 延伸和影响问题（1个）

**示例**:
```json
{
  "proposal_id": "faq_7q",
  "name": "详细版（7个问答）",
  "description": "适合深度报道",
  "item_count": 7,
  "items": [
    {
      "question": "纽约新交通政策的主要内容是什么？",
      "answer": "..."
    },
    {
      "question": "政策什么时候生效？",
      "answer": "..."
    },
    {
      "question": "新政策包括哪些具体限制措施？",
      "answer": "..."
    },
    {
      "question": "这对普通市民有什么影响？",
      "answer": "..."
    },
    {
      "question": "企业和商家如何应对新政策？",
      "answer": "市中心企业有两方面关切：担心客流量下降，但期待长期改善。市政府提供3个月税收减免补偿，并加强公交站商业宣传支持。"
    },
    {
      "question": "如何申请豁免或特殊通行证？",
      "answer": "..."
    },
    {
      "question": "专家对这项政策的评价如何？",
      "answer": "交通专家普遍认为政策方向正确，预计可减少拥堵和污染。但也有批评者担心执行难度大，可能影响商业活动。长期效果需持续观察。"
    }
  ]
}
```

### 5.3 方案对比

| 维度 | 简洁版（3Q） | 标准版（5Q） | 详细版（7Q） |
|------|-------------|-------------|-------------|
| **问答数量** | 3个 | 5个 | 7个 |
| **适用文章长度** | 300-800字 | 800-1500字 | 1500字以上 |
| **信息覆盖度** | 40-50% | 60-70% | 80-90% |
| **用户阅读时间** | <1分钟 | 1-2分钟 | 2-3分钟 |
| **移动端友好度** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ |
| **SEO价值** | 中 | 高 | 非常高 |
| **生成时间** | 10-15秒 | 20-30秒 | 30-45秒 |
| **AI成本** | $0.01 | $0.02 | $0.03 |

---

## 6. FAQ编辑器UI

### 6.1 UI组件设计

#### 主界面布局

```
┌──────────────────────────────────────────────────────────┐
│  FAQ Schema 生成器                              [最小化] │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  【方案选择】                                             │
│  ○ 不使用FAQ Schema                                      │
│  ◉ 简洁版（3个问答）  ○ 标准版（5个问答）  ○ 详细版（7个问答）│
│                                                          │
│  AI生成状态: ✓ 已完成  |  预览  |  重新生成               │
│                                                          │
├──────────────────────────────────────────────────────────┤
│  【问答列表】                                             │
│                                                          │
│  ┌────────────────────────────────────────────────────┐ │
│  │ Q1: 纽约新交通政策主要内容是什么？    [↑] [↓] [✏] [✗]  │ │
│  │                                                    │ │
│  │ A: 新政策包括增加10条公交专用道、限制私家车进入市中心│ │
│  │    、提高停车费用至每小时15美元，以及新增1000辆公交 │ │
│  │    车。                                            │ │
│  │                                                    │ │
│  │ 字数: 62  |  质量评分: ⭐⭐⭐⭐⭐ 0.92                │ │
│  └────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌────────────────────────────────────────────────────┐ │
│  │ Q2: 政策什么时候生效？                [↑] [↓] [✏] [✗] │ │
│  │                                                    │ │
│  │ A: 新政策将从下月1日起实施，分为3个月过渡期（仅警告）│ │
│  │    和之后的全面执法期。                            │ │
│  │                                                    │ │
│  │ 字数: 38  |  质量评分: ⭐⭐⭐⭐ 0.85                 │ │
│  └────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌────────────────────────────────────────────────────┐ │
│  │ Q3: 对市民有什么影响？                [↑] [↓] [✏] [✗] │ │
│  │ ...                                                │ │
│  └────────────────────────────────────────────────────┘ │
│                                                          │
│  [+ 添加问答]  [批量编辑]  [恢复AI建议]                   │
│                                                          │
├──────────────────────────────────────────────────────────┤
│  【JSON-LD预览】                                 [复制] [▼]│
│                                                          │
│  ┌────────────────────────────────────────────────────┐ │
│  │ {                                                  │ │
│  │   "@context": "https://schema.org",               │ │
│  │   "@type": "FAQPage",                             │ │
│  │   "mainEntity": [                                 │ │
│  │     {                                              │ │
│  │       "@type": "Question",                        │ │
│  │       "name": "纽约新交通政策主要内容是什么？",      │ │
│  │       "acceptedAnswer": {                         │ │
│  │         "@type": "Answer",                        │ │
│  │         "text": "新政策包括..."                    │ │
│  │       }                                            │ │
│  │     },                                             │ │
│  │     ...                                            │ │
│  │   ]                                                │ │
│  │ }                                                  │ │
│  └────────────────────────────────────────────────────┘ │
│                                                          │
│  ✓ Schema验证通过  |  大小: 1.2KB  |  [在线验证]          │
│                                                          │
├──────────────────────────────────────────────────────────┤
│  [取消]  [保存草稿]  [应用到文章]                          │
└──────────────────────────────────────────────────────────┘
```

### 6.2 问答编辑对话框

```
┌──────────────────────────────────────────────────┐
│  编辑问答                                   [✗]   │
├──────────────────────────────────────────────────┤
│                                                  │
│  问题:                                           │
│  ┌────────────────────────────────────────────┐ │
│  │ 纽约新交通政策主要内容是什么？             │ │
│  └────────────────────────────────────────────┘ │
│  字数: 14  |  建议: 5-20字  ✓                  │
│                                                  │
│  答案:                                           │
│  ┌────────────────────────────────────────────┐ │
│  │ 新政策包括增加10条公交专用道、限制私家    │ │
│  │ 车进入市中心、提高停车费用至每小时15美元 │ │
│  │ ，以及新增1000辆公交车。                  │ │
│  │                                            │ │
│  │                                            │ │
│  └────────────────────────────────────────────┘ │
│  字数: 62  |  建议: 50-300字  ✓                │
│                                                  │
│  [AI优化答案]  [检查语法]                        │
│                                                  │
│  质量评分: ⭐⭐⭐⭐⭐ 0.92                         │
│  ✓ 答案完整    ✓ 直接回答    ✓ 基于原文          │
│  ⚠ 建议: 可以在答案中加入时间信息                 │
│                                                  │
├──────────────────────────────────────────────────┤
│  [取消]  [保存]                                   │
└──────────────────────────────────────────────────┘
```

### 6.3 方案对比视图

```
┌────────────────────────────────────────────────────────────────┐
│  FAQ方案对比                                                    │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  ┌──────────────┬──────────────┬──────────────┬──────────────┐│
│  │              │ 简洁版（3Q） │ 标准版（5Q） │ 详细版（7Q） ││
│  ├──────────────┼──────────────┼──────────────┼──────────────┤│
│  │ 问答数量      │     3个     │     5个     │     7个     ││
│  │ 覆盖度        │     45%     │     65%     │     85%     ││
│  │ SEO评分      │     7.2     │     8.5     │     9.1     ││
│  │ 阅读时间      │    <1分钟   │   1-2分钟   │   2-3分钟   ││
│  │              │   [选择]    │   [选择]    │   [选择]    ││
│  └──────────────┴──────────────┴──────────────┴──────────────┘│
│                                                                │
│  预览（简洁版）:                                                │
│  ┌──────────────────────────────────────────────────────────┐ │
│  │ Q1: 纽约新交通政策主要内容是什么？                         │ │
│  │ A: 新政策包括增加10条公交专用道...                         │ │
│  │                                                            │ │
│  │ Q2: 政策什么时候生效？                                     │ │
│  │ A: 新政策将从下月1日起实施...                              │ │
│  │                                                            │ │
│  │ Q3: 对市民有什么影响？                                     │ │
│  │ A: 使用公共交通的通勤时间预计减少15%...                    │ │
│  └──────────────────────────────────────────────────────────┘ │
│                                                                │
│  [关闭]                                                         │
└────────────────────────────────────────────────────────────────┘
```

### 6.4 批量操作功能

**功能列表**:

1. **批量调整顺序**
   - 拖拽排序
   - 按重要性自动排序
   - 按时间顺序排序

2. **批量删除**
   - 选中多个问答删除
   - 保留最重要的N个

3. **批量导入/导出**
   - 导出为JSON
   - 从JSON导入
   - 从其他文章复制

4. **批量优化**
   - AI批量改写（更简洁/更详细）
   - 批量检查语法
   - 批量调整长度

---

## 7. WordPress集成

### 7.1 集成方式

#### 方式1：Post Meta存储（推荐）

**优点**:
- 与文章数据关联紧密
- 易于管理和更新
- 支持WordPress标准查询

**实现**:
```php
// 保存FAQ Schema到post meta
add_post_meta(
    $post_id,
    'faq_schema',
    json_encode($faq_data),
    true
);

// 读取FAQ Schema
$faq_schema = get_post_meta($post_id, 'faq_schema', true);
```

#### 方式2：自定义字段（ACF）

**优点**:
- 可视化编辑界面
- 类型验证
- 更灵活的查询

**实现**:
```php
// 使用Advanced Custom Fields
$faq_items = get_field('faq_items', $post_id);
```

### 7.2 JSON-LD注入

#### 注入位置

在`<head>`标签中注入JSON-LD：

```php
function inject_faq_schema($post_id) {
    $faq_schema = get_post_meta($post_id, 'faq_schema', true);

    if (!empty($faq_schema)) {
        $schema_data = json_decode($faq_schema, true);

        echo '<script type="application/ld+json">';
        echo json_encode($schema_data, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT);
        echo '</script>';
    }
}

add_action('wp_head', function() {
    if (is_single()) {
        global $post;
        inject_faq_schema($post->ID);
    }
});
```

#### HTML输出（可选）

在文章内容中显示FAQ：

```php
function display_faq_html($faq_schema) {
    $schema_data = json_decode($faq_schema, true);

    $html = '<div class="faq-section">';
    $html .= '<h2>常见问题</h2>';

    foreach ($schema_data['mainEntity'] as $item) {
        $question = htmlspecialchars($item['name']);
        $answer = htmlspecialchars($item['acceptedAnswer']['text']);

        $html .= '<div class="faq-item">';
        $html .= '<h3 class="faq-question">' . $question . '</h3>';
        $html .= '<div class="faq-answer">' . $answer . '</div>';
        $html .= '</div>';
    }

    $html .= '</div>';

    return $html;
}

// 在文章末尾添加FAQ
add_filter('the_content', function($content) {
    if (is_single()) {
        global $post;
        $faq_schema = get_post_meta($post->ID, 'faq_schema', true);

        if (!empty($faq_schema)) {
            $faq_html = display_faq_html($faq_schema);
            $content .= $faq_html;
        }
    }

    return $content;
});
```

### 7.3 WordPress REST API

```php
// 注册自定义REST API端点
add_action('rest_api_init', function() {
    register_rest_route('cms-automation/v1', '/faq-schema/(?P<id>\d+)', [
        'methods' => 'GET',
        'callback' => 'get_faq_schema',
        'permission_callback' => '__return_true'
    ]);

    register_rest_route('cms-automation/v1', '/faq-schema/(?P<id>\d+)', [
        'methods' => 'POST',
        'callback' => 'update_faq_schema',
        'permission_callback' => function() {
            return current_user_can('edit_posts');
        }
    ]);
});

function get_faq_schema($request) {
    $post_id = $request['id'];
    $faq_schema = get_post_meta($post_id, 'faq_schema', true);

    if (empty($faq_schema)) {
        return new WP_Error('no_faq', 'No FAQ schema found', ['status' => 404]);
    }

    return rest_ensure_response([
        'post_id' => $post_id,
        'faq_schema' => json_decode($faq_schema, true)
    ]);
}

function update_faq_schema($request) {
    $post_id = $request['id'];
    $faq_data = $request->get_json_params();

    // 验证Schema格式
    if (!validate_faq_schema($faq_data)) {
        return new WP_Error('invalid_schema', 'Invalid FAQ schema format', ['status' => 400]);
    }

    // 保存
    update_post_meta($post_id, 'faq_schema', json_encode($faq_data, JSON_UNESCAPED_UNICODE));

    return rest_ensure_response([
        'success' => true,
        'message' => 'FAQ schema updated successfully'
    ]);
}
```

---

## 8. API接口设计

### 8.1 生成FAQ Schema

#### POST /api/articles/{article_id}/generate-faq-schema

**请求**:
```json
{
  "proposals": ["3q", "5q", "7q"],
  "options": {
    "include_reasoning": true,
    "quality_threshold": 0.8
  }
}
```

**响应**:
```json
{
  "success": true,
  "article_id": 123,
  "proposals": [
    {
      "proposal_id": "faq_3q",
      "name": "简洁版（3个问答）",
      "description": "适合短新闻和移动端",
      "item_count": 3,
      "items": [
        {
          "question": "纽约新交通政策主要内容是什么？",
          "answer": "新政策包括...",
          "question_type": "what",
          "priority": "P0",
          "quality_score": 0.92,
          "reasoning": "核心主题问题，用户最关心"
        },
        ...
      ],
      "schema_json_ld": "{...}",
      "overall_quality": 0.89,
      "seo_score": 7.2,
      "estimated_ctr_boost": "25-30%"
    },
    {
      "proposal_id": "faq_5q",
      ...
    },
    {
      "proposal_id": "faq_7q",
      ...
    }
  ],
  "generation_time": 28.5,
  "ai_cost": 0.025
}
```

### 8.2 更新FAQ Schema

#### PUT /api/articles/{article_id}/faq-schema

**请求**:
```json
{
  "selected_proposal_id": "faq_5q",
  "custom_items": [
    {
      "question": "自定义问题",
      "answer": "自定义答案"
    }
  ],
  "modifications": [
    {
      "item_index": 2,
      "field": "answer",
      "new_value": "修改后的答案"
    }
  ]
}
```

**响应**:
```json
{
  "success": true,
  "article_id": 123,
  "final_faq_schema": {...},
  "validation": {
    "passes": true,
    "warnings": []
  }
}
```

### 8.3 验证FAQ Schema

#### POST /api/validate-faq-schema

**请求**:
```json
{
  "faq_schema": {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [...]
  }
}
```

**响应**:
```json
{
  "valid": true,
  "errors": [],
  "warnings": [
    {
      "item_index": 2,
      "field": "answer",
      "message": "答案稍长（420字符），建议精简至300字以内"
    }
  ],
  "schema_org_valid": true,
  "google_compatible": true,
  "quality_score": 0.87
}
```

---

## 9. 质量评估与优化

### 9.1 质量评分维度

| 维度 | 权重 | 评分标准 |
|------|------|---------|
| **问题质量** | 30% | 清晰性、相关性、搜索意图匹配 |
| **答案质量** | 40% | 完整性、准确性、来源可靠性 |
| **SEO价值** | 20% | 关键词包含、结构化、可索引性 |
| **用户体验** | 10% | 可读性、有用性、吸引力 |

### 9.2 自动优化建议

```python
async def analyze_and_suggest_improvements(faq_items: List[FAQItem]) -> List[Suggestion]:
    """分析FAQ并提供优化建议"""
    suggestions = []

    for idx, item in enumerate(faq_items):
        # 问题检查
        if len(item.question) < 5:
            suggestions.append(Suggestion(
                item_index=idx,
                type="question_too_short",
                severity="warning",
                message="问题过短，建议扩展为完整疑问句"
            ))

        # 答案检查
        if len(item.answer) < 50:
            suggestions.append(Suggestion(
                item_index=idx,
                type="answer_insufficient",
                severity="error",
                message="答案过短，缺乏足够信息"
            ))

        elif len(item.answer) > 400:
            suggestions.append(Suggestion(
                item_index=idx,
                type="answer_too_long",
                severity="warning",
                message="答案过长，建议精简或分段"
            ))

        # SEO检查
        if not contains_keywords(item.question, keywords):
            suggestions.append(Suggestion(
                item_index=idx,
                type="missing_keywords",
                severity="info",
                message="建议在问题中自然包含关键词"
            ))

    return suggestions
```

---

## 10. 实现指南

### 10.1 实现步骤

#### 阶段1：基础生成（1周）

- [ ] 实现AI问题生成
- [ ] 实现AI答案生成
- [ ] 生成单一方案（5问答）
- [ ] JSON-LD格式输出

#### 阶段2：多方案支持（1周）

- [ ] 实现3/5/7问答方案生成
- [ ] 方案质量评分
- [ ] 方案对比功能

#### 阶段3：编辑器UI（1-2周）

- [ ] FAQ编辑器组件
- [ ] 问答编辑对话框
- [ ] JSON-LD预览
- [ ] 方案切换功能

#### 阶段4：WordPress集成（1周）

- [ ] Post Meta存储
- [ ] JSON-LD注入
- [ ] REST API端点
- [ ] HTML输出（可选）

#### 阶段5：质量优化（持续）

- [ ] 质量评分系统
- [ ] 自动优化建议
- [ ] A/B测试框架
- [ ] 用户反馈收集

### 10.2 测试清单

- [ ] Schema.org验证通过
- [ ] Google Rich Results Test通过
- [ ] 问答相关性>90%
- [ ] 答案准确性>95%
- [ ] 生成时间<45秒
- [ ] JSON-LD格式正确
- [ ] WordPress集成正常
- [ ] 用户编辑功能完整

---

## 附录

### A. Schema.org参考资源

- 官方文档: https://schema.org/FAQPage
- Google指南: https://developers.google.com/search/docs/appearance/structured-data/faqpage
- 验证工具: https://validator.schema.org/
- Rich Results Test: https://search.google.com/test/rich-results

### B. 示例代码库

完整实现代码参考:
- `backend/src/services/faq_schema_generator.py`
- `backend/src/services/faq_quality_checker.py`
- `frontend/src/components/FAQSchemaEditor.tsx`

---

**文档版本**: 1.0.0
**最后更新**: 2025-10-26
**维护者**: CMS自动化系统团队
**审核状态**: 待审核

