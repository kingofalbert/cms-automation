# Module 1: Article Import UI - 完整测试计划

**创建日期**: 2025-11-02
**测试范围**: Article Import UI (CSV/JSON/Manual)
**前端服务器**: http://localhost:3001/import
**后端API**: http://localhost:8000/api/v1/articles/import/*

---

## 测试环境验证

- [x] 前端开发服务器运行 (port 3001)
- [ ] 后端API服务器运行 (port 8000)
- [ ] 数据库连接正常
- [ ] 测试数据准备完毕

---

## 1. CSV 导入功能测试

### 1.1 文件上传 - Drag & Drop

**测试用例 1.1.1: 拖放CSV文件**
- **步骤**:
  1. 访问 http://localhost:3001/import
  2. 点击"CSV 批量导入"标签
  3. 拖放有效的CSV文件到上传区域
- **预期结果**:
  - 上传区域显示高亮效果
  - 文件被接受并开始解析
  - 显示解析进度
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 1.1.2: 点击选择CSV文件**
- **步骤**:
  1. 点击上传区域
  2. 从文件选择器选择CSV文件
- **预期结果**: 与1.1.1相同
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 1.1.3: 无效文件类型**
- **步骤**: 尝试上传.txt或.pdf文件
- **预期结果**:
  - 显示错误提示："请上传CSV文件"
  - 文件被拒绝
- **实际结果**:
- **状态**: ⏸️ 待测试

### 1.2 CSV 解析与预览

**测试用例 1.2.1: 有效CSV数据**
- **测试数据**:
  ```csv
  title,body,source_url,tags,target_locale
  "测试文章1","这是测试内容1","https://example.com/1","新闻,测试","zh-TW"
  "测试文章2","这是测试内容2","https://example.com/2","科技","zh-TW"
  ```
- **预期结果**:
  - 显示解析后的数据预览表格
  - 显示记录数量（2条）
  - 显示列名匹配状态
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 1.2.2: CSV格式错误**
- **测试数据**: 缺少必需字段的CSV
  ```csv
  title,body
  "测试文章1","内容1"
  ```
- **预期结果**:
  - 显示错误提示："缺少必需字段: source_url"
  - 提供字段映射建议
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 1.2.3: CSV编码问题**
- **测试数据**: GB2312编码的CSV文件
- **预期结果**:
  - 自动检测编码或提示用户选择编码
  - 正确显示中文字符
- **实际结果**:
- **状态**: ⏸️ 待测试

### 1.3 上传进度与反馈

**测试用例 1.3.1: 上传进度条**
- **步骤**: 上传较大的CSV文件（>1MB）
- **预期结果**:
  - 显示实时上传进度（0-100%）
  - 显示上传速度
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 1.3.2: 上传成功反馈**
- **预期结果**:
  - 显示成功消息："成功导入 X 篇文章"
  - 显示导入结果摘要
  - 自动刷新导入历史表格
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 1.3.3: 上传失败处理**
- **测试方法**: 在后端API关闭时尝试上传
- **预期结果**:
  - 显示错误消息："上传失败: 无法连接到服务器"
  - 提供重试按钮
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 2. JSON 导入功能测试

### 2.1 JSON格式验证

**测试用例 2.1.1: 有效JSON数组**
- **测试数据**:
  ```json
  [
    {
      "title": "JSON测试文章1",
      "body": "这是JSON测试内容1",
      "source_url": "https://example.com/json1",
      "tags": ["新闻", "测试"],
      "target_locale": "zh-TW"
    }
  ]
  ```
- **预期结果**:
  - JSON通过验证
  - 显示解析后的数据预览
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 2.1.2: 无效JSON语法**
- **测试数据**:
  ```json
  [
    {
      "title": "测试",
      "body": "内容"  // 缺少逗号
      "source_url": "url"
    }
  ]
  ```
- **预期结果**:
  - 显示JSON语法错误提示
  - 指出错误位置（行号）
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 2.1.3: JSON Schema验证**
- **测试数据**: 缺少必需字段的JSON
  ```json
  [{"title": "测试文章"}]
  ```
- **预期结果**:
  - 显示字段验证错误："缺少必需字段: body, source_url"
- **实际结果**:
- **状态**: ⏸️ 待测试

### 2.2 JSON编辑器功能

**测试用例 2.2.1: 实时语法高亮**
- **步骤**: 在JSON编辑器中输入代码
- **预期结果**:
  - 关键字、字符串、数字显示不同颜色
  - 自动缩进
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 2.2.2: 自动格式化**
- **步骤**: 粘贴未格式化的JSON，点击"格式化"按钮
- **预期结果**: JSON自动美化（proper indentation）
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 3. 手动输入功能测试

### 3.1 基本表单字段

**测试用例 3.1.1: 标题输入**
- **步骤**: 输入文章标题
- **预期结果**:
  - 实时字符计数
  - 最大长度限制提示
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 3.1.2: 富文本编辑器 (Tiptap)**
- **步骤**:
  1. 输入文本内容
  2. 测试格式化按钮（加粗、斜体、标题）
  3. 插入链接
  4. 插入列表
- **预期结果**:
  - 所有格式化功能正常工作
  - 生成正确的HTML
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 3.1.3: 图片上传 (ImageUploadWidget)**
- **步骤**:
  1. 点击"上传图片"
  2. 选择图片文件
  3. 等待上传完成
- **预期结果**:
  - 显示上传进度
  - 图片预览显示
  - 返回图片URL
- **实际结果**:
- **状态**: ⏸️ 待测试

### 3.2 表单验证

**测试用例 3.2.1: 必填字段验证**
- **步骤**: 提交空表单
- **预期结果**:
  - 显示所有必填字段的错误提示
  - 第一个错误字段获得焦点
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 3.2.2: URL格式验证**
- **测试数据**: source_url = "invalid-url"
- **预期结果**: 显示"请输入有效的URL"
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 3.2.3: 标签格式验证**
- **步骤**: 输入标签，用逗号或空格分隔
- **预期结果**:
  - 自动解析为标签数组
  - 显示标签chips
- **实际结果**:
- **状态**: ⏸️ 待测试

### 3.3 表单提交

**测试用例 3.3.1: 成功提交**
- **步骤**: 填写所有必填字段，点击"提交"
- **预期结果**:
  - 显示加载状态
  - 成功后显示"文章已创建"提示
  - 表单重置
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 3.3.2: 提交失败处理**
- **测试方法**: 提交重复的source_url
- **预期结果**:
  - 显示后端返回的错误消息
  - 表单数据保留（不清空）
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 4. 导入历史表格测试

### 4.1 数据显示

**测试用例 4.1.1: 历史记录列表**
- **预期结果**:
  - 显示最近的导入记录
  - 包含：时间、文件名、状态、记录数
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 4.1.2: 状态标识**
- **预期结果**:
  - 成功: 绿色勾选图标
  - 失败: 红色错误图标
  - 进行中: 加载动画
- **实际结果**:
- **状态**: ⏸️ 待测试

### 4.2 交互功能

**测试用例 4.2.1: 查看详情**
- **步骤**: 点击某条导入记录的"详情"按钮
- **预期结果**: 显示导入详细信息（成功/失败的文章列表）
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 4.2.2: 重新导入**
- **步骤**: 点击失败记录的"重试"按钮
- **预期结果**: 重新执行导入操作
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 5. 后端API集成测试

### 5.1 认证与授权

**测试用例 5.1.1: Token认证**
- **步骤**: 检查HTTP请求头
- **预期结果**: 所有API请求包含 `Authorization: Bearer <token>`
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 5.1.2: 未授权处理**
- **测试方法**: 清除localStorage中的token，尝试上传
- **预期结果**:
  - 显示401错误
  - 重定向到登录页
- **实际结果**:
- **状态**: ⏸️ 待测试

### 5.2 API端点验证

**测试用例 5.2.1: CSV批量导入端点**
- **端点**: `POST /api/v1/articles/import/batch`
- **Content-Type**: `multipart/form-data`
- **预期响应**:
  ```json
  {
    "success": true,
    "imported": 10,
    "failed": 0,
    "errors": []
  }
  ```
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 5.2.2: JSON导入端点**
- **端点**: `POST /api/v1/articles/import/json`
- **Content-Type**: `application/json`
- **预期响应**: 同上
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 5.2.3: 手动创建端点**
- **端点**: `POST /api/v1/articles`
- **Content-Type**: `application/json`
- **预期响应**:
  ```json
  {
    "id": 123,
    "title": "...",
    "created_at": "2025-11-02T..."
  }
  ```
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 6. 性能测试

**测试用例 6.1: 大文件上传**
- **测试数据**: 10MB CSV文件（1000+条记录）
- **预期结果**:
  - 上传时间 < 30秒
  - 浏览器不卡顿
  - 进度条平滑更新
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 6.2: 并发上传**
- **测试方法**: 同时上传3个文件
- **预期结果**:
  - 所有上传正常完成
  - 不出现冲突或数据丢失
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 7. 用户体验测试

**测试用例 7.1: 响应式设计**
- **测试设备**:
  - [ ] Desktop (1920x1080)
  - [ ] Tablet (768x1024)
  - [ ] Mobile (375x667)
- **预期结果**: 所有屏幕尺寸下布局正常
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 7.2: 加载状态反馈**
- **预期结果**:
  - 所有异步操作显示加载指示器
  - 按钮在加载时禁用
  - 显示有意义的加载文本
- **实际结果**:
- **状态**: ⏸️ 待测试

**测试用例 7.3: 错误消息友好性**
- **预期结果**:
  - 错误消息清晰明了
  - 提供解决建议
  - 避免技术术语
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 8. 浏览器兼容性测试

**测试用例 8.1: 主流浏览器**
- **测试浏览器**:
  - [ ] Chrome (最新版)
  - [ ] Firefox (最新版)
  - [ ] Safari (最新版)
  - [ ] Edge (最新版)
- **预期结果**: 所有功能在所有浏览器正常工作
- **实际结果**:
- **状态**: ⏸️ 待测试

---

## 测试结果摘要

**开始时间**: 2025-11-02
**完成时间**: _待定_
**测试人员**: Albert King (Claude Code辅助)

**统计**:
- 总测试用例数: 37
- 通过: 0
- 失败: 0
- 阻塞: 0
- 待测试: 37

**发现的问题**:
_待记录_

**修复的问题**:
_待记录_

---

## 测试准备清单

在开始测试前，需要准备以下内容：

### 后端环境
- [ ] 后端API服务器运行在 http://localhost:8000
- [ ] 数据库连接正常
- [ ] 测试用户账号已创建
- [ ] 获取有效的JWT token

### 测试数据
- [ ] 准备有效的CSV测试文件（小、中、大）
- [ ] 准备无效CSV测试文件（格式错误、缺少字段）
- [ ] 准备JSON测试数据（有效、无效、边界情况）
- [ ] 准备测试图片文件

### 工具
- [ ] 浏览器开发者工具（Network、Console）
- [ ] Postman或类似工具（用于API测试）
- [ ] 截图工具（记录问题）

---

**下一步行动**:
1. 启动后端服务器
2. 准备测试数据
3. 开始执行测试用例
4. 记录结果和问题
5. 创建修复任务（如有必要）
